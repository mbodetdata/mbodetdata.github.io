<section id="realisation" class="section" aria-labelledby="work-title">
  <h2 id="work-title">Réalisations récentes</h2>

  {% assign has_dates = false %}
  {% for p in site.data.projets %}{% if p.date %}{% assign has_dates = true %}{% break %}{% endif %}{% endfor %}
  {% if has_dates %}
    {% assign projets_sorted = site.data.projets | sort: "date" | reverse %}
  {% else %}
    {% assign projets_sorted = site.data.projets %}
  {% endif %}

  <div class="carousel" data-carousel="realisations" aria-roledescription="carousel">
    <button class="carousel__btn prev" type="button" aria-label="Défiler vers la gauche" disabled>‹</button>

    <!-- UL = piste, comme pour les certifications -->
    <ul class="carousel__track" role="listbox" aria-label="Liste de réalisations">
      {% for projet in projets_sorted %}
      {% assign idx = forloop.index0 %}
      <li class="carousel__slide" role="option" aria-describedby="proj-desc-{{ idx }}">
        <article class="card project-card"
                 tabindex="0"
                 data-index="{{ idx }}"
                 data-title="{{ projet.title | escape }}"
                 data-client="{{ projet.client | escape }}"
                 data-abstract="{{ projet['text-short'] | default: projet.text | escape }}"
                 data-link="{{ projet.link | relative_url }}"
                 data-contexte="{{ projet.details.contexte | escape }}"
                 data-missions='{{ projet.details.missions | jsonify }}'
                 data-benefices='{{ projet.details.benefices | jsonify }}'
                 data-stack='{{ projet.details.stack | jsonify }}'>

          <h3 class="card-title">{{ projet.title }}</h3>
          <p class="lead" id="proj-desc-{{ idx }}">{{ projet["text-short"] }}</p>

          <div class="card-actions">
            <button class="btn btn--details open-project" type="button"
                    aria-label="Voir les détails du projet {{ projet.title | escape }}">
              Détails
            </button>
          </div>
        </article>
      </li>
      {% endfor %}
    </ul>

    <button class="carousel__btn next" type="button" aria-label="Défiler vers la droite">›</button>

    <div class="carousel__dots" aria-label="Sélecteur de slides"></div>
  </div>
</section>
